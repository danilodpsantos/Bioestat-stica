---
title: "Modelos lineares aula 1"
author: "Danilo de Paula Santos/Gabriela Wunsch Lopes"
date: "17/10/2019"
output:
  word_document: default
  pdf_document:
    latex_engine: pdflatex
  html_document: default
---

```{r preparacao_do_R, message=FALSE, warning=FALSE}

# install.packages("compareGroups")
# install.packages("ggplot2")
# install.packages("data.table")


library("compareGroups")
library("ggplot2")
library("haven")

```

# Estuda da relação entre infecção por acilóstomo e perda de sangue. Tailândia 1970

```{r carregando_suwit}

suwit <- read_sav("C:/Users/00265021/Documents/Cadeiras/Modelos lineares/Suwit.sav")

```

```{r descritiva_suwit}

compare_suwit <- compareGroups( ~ ., data = suwit)

summary(compare_suwit)
```

```{r tabela_suwit}

tabela_suwit <- createTable(compare_suwit)

```


```{r suwit_scatter }

suwit_scatter <- ggplot(suwit, aes(x = vermes, y = perda_sangue))+
  geom_point() +
  theme_minimal()

suwit_scatter
```

```{r suwit_regression}

lm_suwit <- lm(formula = perda_sangue ~ vermes,
                    data = suwit)

summary(lm_suwit)

```

``` {r confint_suwit }

confint(lm_suwit)

```

A cada aumento 1 verme, ocorre um aumento de 0.04 (95%IC 0.026 - 0.056)


```{r suwit_regression }

suwit_regression <- ggplot(suwit, aes(x = vermes, y = perda_sangue))+
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  theme_minimal() +
  labs(title = paste("Adj R2 = ",signif(summary(lm_suwit)$adj.r.squared, 5),
                         "Intercept =",signif(lm_suwit$coef[[1]],5 ),
                         " Slope =",signif(lm_suwit$coef[[2]], 5),
                         " p =",signif(summary(lm_suwit)$coef[2,4], 5)))

suwit_regression
```



# Estudo Fat_dat "Fitting Percentage of Body Fat to Simple Body Measurements"


```{r carregando_fat_dat}

fat_dat <- read_sav("C:/Users/00265021/Documents/Cadeiras/Modelos lineares/fat_dat.sav")

```

Corrigindo os erros de digitação:

- The body densities for cases 48, 76, and 96, for instance, each seem to have one digit in error as can be seen from the two body fat percentage values.
- Case 42) over 200 pounds in weight who is less than 3 feet tall (the height should presumably be 69.5 inches, not 29.5 inches)!
- The percent body fat estimates are truncated to zero when negative (case 182)

```{r corrigindo_fat_dat}
# Altura

fat_dat$altura_pol <- ifelse( fat_dat$numero == 42, 69.5, fat_dat$altura_pol)

# Densidades

fat_dat$densidade <- ifelse( fat_dat$numero == 48, 1.0865, fat_dat$densidade)
fat_dat$densidade <- ifelse( fat_dat$numero == 76, 1.0566, fat_dat$densidade)
fat_dat$densidade <- ifelse( fat_dat$numero == 96, 1.0591, fat_dat$densidade)

```

```{r descritivas_fat_dat}
compare_fat <- compareGroups( ~ ., data = fat_dat)

summary(compare_fat)
```


```{r tabela_fat_dat}

tabela_fat <- createTable(compare_fat)

```

```{r normalidade_fat_dat }

plot(compare_fat)

```

```{r dispersao_fat_dat }

disp_fat_dat <- ggplot(fat_dat, aes(x = imc, y = fat_Brozek))+
  geom_point() +
  theme_minimal()

disp_fat_dat
```

```{r regressao_linear_fat_dat }

lm_imc_brozek <- lm(formula = fat_Brozek ~ imc,
                    data = fat_dat)

summary(lm_imc_brozek)

```
``` {r confint_linear_fat_dat }

confint(lm_imc_brozek)

```

A cada aumento de 1 unidade no IMC ocorre aumento de 1.55% na gordura corporal. O intervalo de confiança é de 1.36 a 1.73.



